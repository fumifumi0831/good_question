# 徹底調査結果: 継続の心理学とインフラ戦略

## 1. Duolingo型継続の心理学 (なぜ続出するのか)

### 損失回避 (Loss Aversion)
- **ストリーク (Streaks)**: 連続記録を「失うことへの恐怖」が強力な動機になります。
- **回復手段**: 「ストリークフリーズ」により、一度の失敗で全てを失わず、サンクコスト（これまでの努力）を守る仕組みが心理的安全性を提供します。

### フィードバックループ (Feedback Loops)
- **即時性**: 正誤に対する即時の音・視覚演出。オペラント条件づけによる「即時強化」が快感を生みます。
- **スモールステップ**: 1セッションを短く（マイクロラーニング）し、完了の達成感を頻繁に提供します。

### 変動報酬 (Variable Rewards)
- **予測不能な報酬**: スロットマシンのように、時折得られる特別なバッジやXPボーナスが脳を飽きさせません。

---

## 2. データベース選定 (Next.js基盤)

| 選択肢              | メリット                    | デメリット                               | 今回の推奨                  |
| :------------------ | :-------------------------- | :--------------------------------------- | :-------------------------- |
| **LocalStorage**    | 設定ゼロ、高速、無料        | 同一ブラウザ限定、サーバー側アクセス不可 | **開発初期 / 匿名利用**     |
| **Vercel Postgres** | Next.js親和性、堅牢、共有可 | 有料枠の制限、セットアップ工数           | **本格展開 / 複数端末同期** |
| **SQLite (KV)**     | ファイルベース、軽量        | サーバーレス環境での永続化が課題         | **プロトタイプ用**          |

**戦略的提案**:
まずは **LocalStorage** で「攻略ノート」や「成長履歴」を即座に実装し、ユーザー数が増えた段階で **Supabase** または **Vercel Postgres** への移行パス（エクスポート/インポート）を用意するのが、スピードと体験のバランスが最も良いです。

---

## 3. AI応答・スコアリング戦略

### マルチプロンプト (Chain-of-Thought) の適否
- **単一プロンプト**: 速度・コスト優先。単純な「到達度」のみならこれで十分。
- **マルチプロンプト (推奨)**: 
    - ステップ1: 会話分析 (論理的穴の特定)
    - ステップ2: 詳細スコアリングとフィードバック
    - **メリット**: 「なぜその点数なのか」の根拠が極めて正確になり、信頼性が増します。
    - **実装**: UXを損なわないよう、バックグラウンドでの並列処理、または「分析中...」のステータス表示を工夫します。

---

## 次のアクション
- `@タスク/実装方針.md` に具体的なDBスキーマ（LocalStorage用）を定義。
- `app/api/chat/route.ts` に分析専用の第2プロンプトを統合する準備。
