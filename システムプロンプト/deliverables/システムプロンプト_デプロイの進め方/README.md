# デプロイの進め方（CI/CD 構築）

アプリケーションのデプロイプロセスを設計・構築・運用するためのシステムプロンプトセットです。デプロイ方式（ZIP、Docker、GitHub Actions、Azure Pipelines など）に依存しない汎用的なアプローチを提供します。

---

## 概要

このシステムプロンプトセットは、以下のワークフローを支援します：

```
デプロイ要件の明確化
  ↓
計画フェーズ（CI/CDパイプラインの設計）
  ↓
実装フェーズ（パイプラインの実装と検証）
  ↓
運用フェーズ（デプロイとモニタリング）
  ↓
完了
```

---

## ファイル構成

### 1. メインプロンプト (`00_CI_CD構築システムプロンプト_メイン.md`)

**目的**: 基本原則と全体フローを理解する

**使用タイミング**: CI/CD 構築を開始する際に最初に読み込む

**内容**:

- 役割と基本原則
- 全体フロー
- 各フェーズグループの概要
- 使い方

---

### 2. 計画フェーズ (`01_計画フェーズ.md`)

**目的**: CI/CD パイプラインの設計と計画を立てる

**使用タイミング**: デプロイ要件を明確化した後、最初に進めるフェーズ

**含まれるフェーズ**:

- **フェーズ 1: デプロイ要件の明確化**: デプロイ先、デプロイ方式、環境変数などの要件を明確化
- **フェーズ 2: CI/CD パイプラインの設計**: 各ステップ（ビルド、テスト、デプロイ）を設計
- **フェーズ 3: ローカル検証方法の設計**: クラウド上では見えにくいパイプラインをローカルで再現する方法を設計

**入力**:

- アプリケーションの構成（フロントエンド、バックエンド）
- デプロイ先（Azure App Service、AWS、GCP など）
- デプロイ方式（ZIP、Docker、GitHub Actions、Azure Pipelines など）

**出力**:

- デプロイ要件ドキュメント
- CI/CD パイプライン設計書
- ローカル検証方法の設計書

---

### 3. 実装フェーズ (`02_実装フェーズ.md`)

**目的**: CI/CD パイプラインを実装し、ローカルで検証する

**使用タイミング**: パイプライン設計が完了した後

**含まれるフェーズ**:

- **フェーズ 4: ローカル検証スクリプトの実装**: パイプラインの各ステップをローカルで再現するスクリプトを作成
- **フェーズ 5: CI/CD パイプラインの実装**: 実際の CI/CD パイプライン（GitHub Actions、Azure Pipelines など）を実装
- **フェーズ 6: ローカル検証の実施**: ローカルでパイプラインを再現し、問題を発見・修正

**入力**:

- CI/CD パイプライン設計書
- ローカル検証方法の設計書

**出力**:

- ローカル検証スクリプト
- CI/CD パイプライン設定ファイル
- 検証結果レポート

---

### 4. 運用フェーズ (`03_運用フェーズ.md`)

**目的**: デプロイを実行し、モニタリングと改善を継続する

**使用タイミング**: パイプライン実装とローカル検証が完了した後

**含まれるフェーズ**:

- **フェーズ 7: デプロイの実行**: 実際にデプロイを実行し、動作確認
- **フェーズ 8: モニタリングと改善**: デプロイ後の動作をモニタリングし、問題があれば改善

**入力**:

- CI/CD パイプライン設定ファイル
- 検証結果レポート

**出力**:

- デプロイ結果レポート
- モニタリング結果
- 改善提案

---

## 使い方

### ステップ 1: メインプロンプトの読み込み

1. `00_CI_CD構築システムプロンプト_メイン.md` を AI に読み込ませる
2. 基本原則と全体フローを理解する

### ステップ 2: 計画フェーズ

1. `01_計画フェーズ.md` を参照
2. デプロイ要件を提供する：
   ```
   アプリケーション構成: [フロントエンド、バックエンドなど]
   デプロイ先: [Azure App Service、AWS、GCPなど]
   デプロイ方式: [ZIP、Docker、GitHub Actions、Azure Pipelinesなど]
   環境変数: [必要な環境変数のリスト]
   ```
3. フェーズ 1: デプロイ要件の明確化を実施
4. フェーズ 2: CI/CD パイプラインの設計を実施
5. フェーズ 3: ローカル検証方法の設計を実施
6. 設計が完了したら、次のステップへ

**例**:

```
アプリケーション構成: React (Vite) + Python (FastAPI)
デプロイ先: Azure App Service
デプロイ方式: ZIP (Azure Pipelines)
環境変数: VITE_API_BASE, VITE_AZURE_SPEECH_KEY, VITE_AZURE_SPEECH_REGION
```

### ステップ 3: 実装フェーズ

1. `02_実装フェーズ.md` を参照
2. フェーズ 4: ローカル検証スクリプトの実装を実施
3. フェーズ 5: CI/CD パイプラインの実装を実施
4. フェーズ 6: ローカル検証の実施を実施
5. 検証が完了したら、次のステップへ

### ステップ 4: 運用フェーズ

1. `03_運用フェーズ.md` を参照
2. フェーズ 7: デプロイの実行を実施
3. フェーズ 8: モニタリングと改善を実施
4. すべて完了したら終了

---

## 重要な原則

### 1. ローカルでの再現を最優先

クラウド上では見えにくい CI/CD パイプラインを、ローカルで再現することで理解を深め、問題を早期発見してください。

### 2. デプロイ方式に依存しない設計

ZIP、Docker、GitHub Actions など、特定のデプロイ方式にロックインしない汎用的な設計を心がけてください。

### 3. 段階的な検証

一度にすべてを解決しようとせず、各ステップを順次検証してください。

### 4. 継続的な改善

デプロイ後も継続的にモニタリングし、改善を続けてください。

---

## よくある質問

### Q: どのデプロイ方式を選べばいいですか？

A: アプリケーションの構成、デプロイ先、チームのスキルなどを考慮して選択してください。このシステムプロンプトは、どのデプロイ方式でも適用できます。

### Q: ローカル検証は必須ですか？

A: 必須ではありませんが、強く推奨します。ローカル検証により、クラウド上では見えにくい問題を早期発見できます。

### Q: 複数のデプロイ方式を同時に使えますか？

A: はい、可能です。例えば、開発環境は GitHub Actions、本番環境は Azure Pipelines という使い分けも可能です。

### Q: デプロイが失敗した場合はどうすればいいですか？

A: ローカル検証スクリプトを実行して、問題を特定してください。問題が特定できたら、修正して再デプロイしてください。

---

## 更新履歴

- 2024-12-08: 初版作成（汎用的な CI/CD 構築システムプロンプト）
