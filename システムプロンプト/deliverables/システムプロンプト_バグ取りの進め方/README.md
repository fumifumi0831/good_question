# バグ取りの進め方

アプリケーションで発生したエラーの根本原因を特定し、再発防止策まで導出するためのシステムプロンプトセットです。

---

## 概要

このシステムプロンプトセットは、以下のワークフローを支援します：

```
エラー発生
  ↓
調査フェーズ（問題記録 + 仮説形成）
  ↓
検証フェーズ（仮説検証）
  ↓
修正フェーズ（修正方針決定 + 実施 + 再発防止策）
  ↓
完了
```

---

## ファイル構成

### 1. メインプロンプト (`00_バグ取りシステムプロンプト_メイン.md`)

**目的**: 基本原則と全体フローを理解する

**使用タイミング**: バグ取りを開始する際に最初に読み込む

**内容**:

- 役割と基本原則
- 全体フロー
- 各フェーズグループの概要
- 使い方

---

### 2. 調査フェーズ (`01_調査フェーズ（フェーズ1-2）.md`)

**目的**: エラーの全体像を把握し、検証可能な仮説を複数立てる

**使用タイミング**: エラー情報を提供した後、最初に進めるフェーズ

**含まれるフェーズ**:

- **フェーズ 1: 問題の明確化と記録**: エラーの全体像を把握し、再現可能な形で記録
- **フェーズ 2: 仮説形成**: 症状から原因を体系的に推論し、検証可能な仮説を複数立てる

**入力**:

- エラーメッセージ
- エラーの発生状況
- 再現条件

**出力**:

- 問題記録ドキュメント
- 仮説リスト（3-5 個）

---

### 3. 検証フェーズ (`02_検証フェーズ（フェーズ3）.md`)

**目的**: 仮説を体系的に検証し、最短で根本原因を特定する

**使用タイミング**: 仮説リストが完成した後

**含まれるフェーズ**:

- **フェーズ 3: 仮説検証の効率化**: 仮説を体系的に検証し、根本原因を特定

**入力**:

- 仮説リスト

**出力**:

- 検証結果
- 原因特定ドキュメント

---

### 4. 修正フェーズ (`03_修正フェーズ（フェーズ4-6）.md`)

**目的**: 根本原因を基に修正を実施し、再発防止策まで導出する

**使用タイミング**: 根本原因が特定された後

**含まれるフェーズ**:

- **フェーズ 4: 修正方針の決定**: 特定された根本原因を基に、適切な修正方針を決定
- **フェーズ 5: 修正実施と検証**: 修正を実装し、エラーが解消されたことを確認
- **フェーズ 6: 再発防止策の導出**: 同じ問題が再発しないための対策を明確化

**入力**:

- 根本原因

**出力**:

- 修正方針
- 修正コード
- 検証結果
- 再発防止策

---

## 使い方

### ステップ 1: メインプロンプトの読み込み

1. `00_バグ取りシステムプロンプト_メイン.md` を AI に読み込ませる
2. 基本原則と全体フローを理解する

### ステップ 2: 調査フェーズ

1. `01_調査フェーズ（フェーズ1-2）.md` を参照
2. エラー情報を提供する：
   ```
   エラーメッセージ: [エラーメッセージ]
   発生環境: [環境情報]
   再現条件: [再現手順]
   影響範囲: [影響の説明]
   ```
3. フェーズ 1: 問題の明確化と記録を実施
4. フェーズ 2: 仮説形成を実施
5. 仮説リストが完成したら、次のステップへ

**例**:

```
エラーメッセージ: 502 Bad Gateway
発生環境: Azure App Service（本番環境）
再現条件: ストリーミングエンドポイントへのPOSTリクエスト時
影響範囲: チャット機能のストリーミング表示が利用できない
```

### ステップ 3: 検証フェーズ

1. `02_検証フェーズ（フェーズ3）.md` を参照
2. フェーズ 3: 仮説検証の効率化を実施
3. 根本原因が特定されたら、次のステップへ

### ステップ 4: 修正フェーズ

1. `03_修正フェーズ（フェーズ4-6）.md` を参照
2. フェーズ 4: 修正方針の決定を実施
3. フェーズ 5: 修正実施と検証を実施
4. フェーズ 6: 再発防止策の導出を実施
5. すべて完了したら終了

---

## 重要な原則

### 1. 根本原因の特定を最優先

表面的な症状ではなく、なぜそのエラーが発生したかの本質的原因を特定してください。

### 2. 仮説は必ず検証する

仮説は必ず検証してから修正方針を決定してください。検証なしの仮説に基づく修正は避けてください。

### 3. 再発防止策を必ず検討する

修正後は必ず再発防止策を検討してください。同じ問題が再発しないための対策を明確化してください。

### 4. 段階的に進める

一度にすべてを解決しようとせず、各フェーズを順次進めてください。

---

## よくある質問

### Q: 複数の根本原因が特定された場合はどうすればいいですか？

A: 各原因に対して個別に修正方針を決定し、優先順位を付けて実装してください。原因間の関連性がある場合は、統合的な修正方針を検討してください。

### Q: 根本原因が特定できない場合はどうすればいいですか？

A: 以下のアプローチを試してください：

1. より詳細なログを取得する
2. 追加の仮説を立てる
3. 環境差分をより詳細に比較する
4. 専門家に相談する

### Q: 応急処置だけで対応してもいいですか？

A: 応急処置は一時的な回避策として有効ですが、必ず根本原因を特定し、根本修正を実施してください。応急処置だけで終わらせると、同じ問題が再発する可能性が高くなります。

### Q: 再発防止策は必ず実装する必要がありますか？

A: 優先度の高い再発防止策は必ず実装してください。優先度の低い対策は、リソースと効果を考慮して判断してください。

---

## 更新履歴

- 2025-01-27: 初版作成（分割版）
