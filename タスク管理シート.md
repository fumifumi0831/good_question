# プロジェクト：Good Question (AI対話型コンサルタント育成キット)

## 📌 現在のステータス
- **フェーズ**: Phase 2 完了 / Phase 3 開始
- **目標**: 過去の履歴を蓄積し、長期的な「成長トレンド」を可視化する

---

## 🛠 タスク・進捗一覧

### 1. 基盤・Phase 1：AI伴走インタビュー機能 (完了)
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Init]** データベース・テスト環境の構築 | - | 2025-12-25 | ✅ 完了 | Dexie, Vitest 導入済 |
| **[Init]** AIプロンプトの日本語化・役割分離 | - | 2025-12-25 | ✅ 完了 | 4ロール定義済 |
| **[Impl: Phase 1]** 動的シナリオガチャの実装 | 25分×1 | 2025-12-25 | ✅ 完了 | 弱点反映ロジック |
| **[Impl: Phase 1]** 脈打つヘルプボタンコンポーネント | 25分×1 | 2025-12-25 | ✅ 完了 | Framer Motion |
| **[Impl: Phase 1]** 「上司の助け舟」モーダル UI | 25分×1 | 2025-12-25 | ✅ 完了 | ポップアップ表示 |
| **[Impl: Phase 1]** 総合結合テストと挙動調整 | 25分×2 | 2025-12-25 | ✅ 完了 | 全体フロー確認済 |
| **[Verify]** 真因到達度メーターの連動確認 | 25分×1 | 2025-12-25 | ✅ 完了 | UI同期確認済 |

### 2. Phase 2：外科手術型添削 (完了)
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Impl: Phase 2]** Reviewer の分析ロジック (JSON ID指定) | 25分×2 | 2025-12-26 | ✅ 完了 | 特定発言のピンポイント抽出 |
| **[Impl: Phase 2]** Recharts 等によるチャート基盤導入 | 25分×1 | 2025-12-26 | ✅ 完了 | ライブラリ設置と検証 |
| **[Impl: Phase 2]** 評価レポート画面のレイアウト構築 | 25分×1 | 2025-12-26 | ✅ 完了 | モダール/別画面 |
| **[Impl: Phase 2]** スコアデータのチャート連動 | 25分×2 | 2025-12-26 | ✅ 完了 | 動的可視化 |
| **[Impl: Phase 2]** 改善案（Better Version）の比較 UI | 25分×1 | 2025-12-26 | ✅ 完了 | Before/Afterカード |
| **[Verify]** 指摘メッセージと ID の不整合がないか検証 | 25分×1 | 2025-12-26 | ✅ 完了 | ロジックテスト |
| **[Push]** Phase 2 成果物の Git プッシュ | 5分 | 2025-12-25 | ✅ 完了 | リモート同期 |

### 3. Phase 3：成長可視化・縦軸分析 (完了)
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Impl: Phase 3]** セッション履歴一覧画面の実装 | 25分×2 | 2025-12-27 | ✅ 完了 | パフォーマンス画面として実装済 |
| **[Impl: Phase 3]** 時系列スコア推移グラフの作成 | 25分×2 | 2025-12-27 | ✅ 完了 | Rechartsによる可視化完了 |
| **[Impl: Phase 3]** 弱点タグの自動集計・統計ロジック | 25分×3 | 2025-12-27 | ✅ 完了 | stats-utils.ts 実装済 |
| **[Impl: Phase 3]** Mentor プロンプトへの分析結果注入 | 25分×1 | 2025-12-27 | ✅ 完了 | パーソナライズ強化完了 |

### 4. メンテナンス・バグ修正 (完了)
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Fix]** トレーニング開始時の API 500 エラー修正 | 15分 | 2025-12-25 | ✅ 完了 | APIキー設定、履歴処理修正 |
| **[Fix]** API応答の TypeError 対策 (match on undefined) | 5分 | 2025-12-25 | ✅ 完了 | エラーハンドリング強化 |
| **[UX]** チャット入力の Shift+Enter 挙動修正 | 10分 | 2025-12-25 | ✅ 完了 | Textarea化 |
| **[Bug]** API 応答エラー (Internal Server Error) の原因調査と修正 | 20分 | 2025-12-26 | ✅ 完了 | Gemini 履歴形式の修正 |
| **[Bug]** 上司の助け舟のマークダウン表示改善 | 10分 | 2025-12-26 | ✅ 完了 | react-markdown 導入 |
| **[Bug]** Enter キー押下時のチャット送信問題の修正 | 5分 | 2025-12-26 | ✅ 完了 | 空入力チェック追加 |
| **[Bug]** IME 変換確定時の誤送信防止 | 10分 | 2025-12-26 | ✅ 完了 | isComposing フラグ追加 |
| **[Bug]** 会話の文脈が繋がらない問題の調査と修正 | 20分 | 2025-12-26 | ✅ 完了 | 履歴送信ロジック修正 |

### 5. Phase 4: サービス化準備

#### Phase 4.1: UI 改善
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[UI]** トレーニング開始ボタンの配置調整 | 5分 | 2025-12-26 | ⏳ 未着手 | サイドバー中央配置 |
| **[Test]** UI 改善の動作確認 | 5分 | 2025-12-26 | ⏳ 未着手 | ブラウザで確認 |

#### Phase 4.2: Supabase バックエンド構築
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Setup]** Supabase プロジェクト作成と設定 | 30分 | 2025-12-27 | ⏳ 未着手 | 認証プロバイダー設定 |
| **[Impl]** データベーススキーマ作成 | 45分 | 2025-12-27 | ⏳ 未着手 | 5テーブル作成 |
| **[Impl]** RLS ポリシー設定 | 30分 | 2025-12-27 | ⏳ 未着手 | セキュリティ設定 |
| **[Impl]** Supabase クライアントヘルパー作成 | 15分 | 2025-12-27 | ⏳ 未着手 | client.ts, server.ts |
| **[Impl]** Middleware 実装 | 20分 | 2025-12-27 | ⏳ 未着手 | セッション更新、ルート保護 |
| **[Impl]** storage.ts を Supabase に移行 | 60分 | 2025-12-27 | ⏳ 未着手 | CRUD 操作変更 |
| **[Test]** Supabase 連携テスト | 30分 | 2025-12-27 | ⏳ 未着手 | CRUD 操作確認 |

#### Phase 4.3: ランディングページと認証フロー
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Impl]** ルート構成の変更 | 30分 | 2025-12-28 | ⏳ 未着手 | / を LP、/app をアプリに |
| **[Impl]** ランディングページ UI 実装 | 120分 | 2025-12-28 | ⏳ 未着手 | 独自デザイン |
| **[Impl]** サインインページ実装 | 45分 | 2025-12-28 | ⏳ 未着手 | Email/Password, OAuth |
| **[Impl]** サインアップページ実装 | 45分 | 2025-12-28 | ⏳ 未着手 | Email/Password, OAuth |
| **[Impl]** OAuth コールバックハンドラー実装 | 30分 | 2025-12-28 | ✅ 完了 | Google OAuth |
| **[Bug]** ルート競合エラーの修正 | 15分 | 2025-12-27 | ✅ 完了 | (app) と (marketing) の競合 |
| **[Bug]** Client Component での Server 機能使用エラー修正 | 20分 | 2025-12-27 | ✅ 完了 | storage.ts の修正 |
| **[Bug]** Dexie API 互換性エラーの修正 | 15分 | 2025-12-27 | ✅ 完了 | stats-utils.ts の修正 |
| **[Bug]** サインアップ失敗の調査と修正 | 30分 | 2025-12-27 | ⏳ 未着手 | API Key 修正待ち |
| **[Bug]** ユーザー統計読み込みエラーの修正 | 20分 | 2025-12-27 | ✅ 完了 | エラーハンドリング追加 |
| **[Bug]** Google OAuth リダイレクト URI エラーの修正 | 20分 | 2025-12-27 | ✅ 完了 | Google Cloud Console 設定 |
| **[Bug]** トレーニング開始時のセッション作成エラー修正 | 30分 | 2025-12-28 | ✅ 完了 | テーブル作成完了 |
| **[Impl]** ログアウトボタンの実装 | 15分 | 2025-12-28 | ✅ 完了 | サイドバーに追加 |
| **[Test]** 認証フローテスト | 45分 | 2025-12-28 | ✅ 完了 | サインアップ、サインイン、OAuth |

#### Phase 4.4: 利用制限機能
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Impl]** usage_logs テーブル作成 | 15分 | 2025-12-29 | ⏳ 未着手 | Supabase DB |
| **[Impl]** 利用制限チェック関数実装 | 45分 | 2025-12-29 | ⏳ 未着手 | usage-limit.ts |
| **[Impl]** トレーニング開始時の制限チェック統合 | 20分 | 2025-12-29 | ⏳ 未着手 | page.tsx 修正 |
| **[Impl]** 制限超過時の UI 表示 | 30分 | 2025-12-29 | ⏳ 未着手 | 課金ページへの導線 |
| **[Test]** 利用制限テスト | 30分 | 2025-12-29 | ⏳ 未着手 | 一日一回制限、日次リセット |

#### Phase 4.5: Stripe 課金連携
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Setup]** Stripe プロダクト作成 | 20分 | 2025-12-30 | ⏳ 未着手 | Free、Pro 980円 |
| **[Impl]** Stripe Checkout API 実装 | 60分 | 2025-12-30 | ⏳ 未着手 | checkout/route.ts |
| **[Impl]** Stripe Webhook ハンドラー実装 | 60分 | 2025-12-30 | ⏳ 未着手 | webhook/route.ts |
| **[Impl]** 料金プランページ実装 | 60分 | 2025-12-30 | ⏳ 未着手 | pricing/page.tsx |
| **[Test]** Stripe 連携テスト | 60分 | 2025-12-30 | ⏳ 未着手 | Checkout, Webhook, サブスク同期 |

#### Phase 4.6: 統合テストとデプロイ
| タスク名 | 推定工数 | 期限 | ステータス | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **[Test]** 認証からトレーニングまでのフローテスト | 30分 | 2025-12-31 | ⏳ 未着手 | E2E テスト |
| **[Test]** 無料プランの制限テスト | 20分 | 2025-12-31 | ⏳ 未着手 | 一日一回制限 |
| **[Test]** 有料プランへのアップグレードテスト | 30分 | 2025-12-31 | ⏳ 未着手 | Stripe 課金フロー |
| **[Deploy]** Vercel へのデプロイ | 30分 | 2025-12-31 | ⏳ 未着手 | 環境変数設定 |
| **[Test]** 本番環境での動作確認 | 30分 | 2025-12-31 | ⏳ 未着手 | 全機能確認 |

---

## 📝 開発上の注意点
- **IndexedDB の永続性**: 開発中のスキーマ変更時は `db.version` を上げるか DB名を変えること。
- **AI 応答のパース**: JSON を含む場合は正規表現や `find_json` ユーティリティで堅牢に抽出すること。
- **Git 運用**: 各フェーズの検証（Verify）完了後に必ず push すること。